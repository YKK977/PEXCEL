<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>PEXCEL</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="title-area">
      <span class="title-main">PEXCEL</span>
      <span class="title-sub">ÌéôÏÖÄ</span>
    </div>
    <div id="mode-selector">
      <label for="category-select">Category:</label>
      <select id="category-select">
        <option value="vessel" selected>Vessel Calculations</option>
        <option value="pump">Pump Calculations</option>
        <option value="heat-exchanger">Heat Exchanger Calculations</option>
        <option value="instrumentation">Instrumentation Calculations</option>
        <option value="line-sizing">Line Sizing Calculations</option>
        <option value="physical-properties">Physical Properties</option>
      </select>
    </div>
  </header>

  <main>
    <nav id="index-vessel" class="sub-index" style="display:none;">
      <div class="sub-index-title">Index</div>
      <a href="#block-5">Vertical Vessel Volume (Liquid Level)</a>
      <a href="#block-6">Horizontal Vessel Volume (Liquid Level)</a>
      <a href="#section-residence">Residence Time</a>
    </nav>

    <nav id="index-pump" class="sub-index" style="display:none;">
      <div class="sub-index-title">Index</div>
      <a href="#section-npsh">NPSHa Calculation</a>
      <a href="#section-pump-power">Hydraulic Power &amp; Shaft Power</a>
      <a href="#section-static-head">Static Head Calculation</a>
    </nav>

    <nav id="index-heat-exchanger" class="sub-index" style="display:none;">
      <div class="sub-index-title">Index</div>
      <a href="#section-heat-duty">Heat Duty / Outlet Temperature / Required Area</a>
      <a href="#section-steam-duty">Steam / Condensate Duty &amp; Mass Flow</a>
    </nav>

    <nav id="index-instrumentation" class="sub-index" style="display:none;">
      <div class="sub-index-title">Index</div>
      <a href="#section-cv-invert">Cv Inversion (Q ‚Üî ŒîP)</a>
      <a href="#section-orifice">Restriction Orifice ‚Äì Liquid Flow</a>
    </nav>

    <nav id="index-line-sizing" class="sub-index" style="display:none;">
      <div class="sub-index-title">Index</div>
      <a href="#block-ls1">Liquid Line Sizing (Mass Flow)</a>
      <a href="#block-ls2">Liquid Line Sizing (Volumetric Flow)</a>
      <a href="#block-ls3">Vapor Darcy Pressure Drop (Approx.)</a>
      <a href="#block-ls3">Erosional Velocity / Gas Velocity Check</a>
    </nav>

    <nav id="index-physical-properties" class="sub-index" style="display:none;">
      <div class="sub-index-title">Index</div>
      <a href="#section-mass-volume">Mass and Volume Flowrate Calculation</a>
      <a href="#section-combined-gas">Combined Gas Law</a>
      <a href="#section-gas-density">Gas Density Calculation</a>
      <a href="#section-mixing-temp">Mixing Temperature (Two-Stream)</a>
    </nav>

    <!-- Section 1: Mass & Volume Flowrate (default) -->
    <section id="section-mass-volume">
      <section id="sheet-container">
        <!-- Block 1: Mass ‚Üí Volume -->
        <div class="block" id="block-1">
          <div class="block-header">
            <h2>Mass ‚ñ∂ Volume Flowrate</h2>
            <button class="btn-copy" data-block="1">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col />
              <col />
              <col />
            </colgroup>
            <tr>
              <th>Mass Flowrate<br><span class="unit">kg/h</span></th>
              <th>MW<br><span class="unit">kg/kmol</span></th>
              <th>Volume Flowrate<br><span class="unit">Nm¬≥/h</span></th>
            </tr>
            <tr>
              <td><input type="number" id="mass1" value="203.0" step="0.1" /></td>
              <td><input type="number" id="mw1" value="29.0" step="0.1" /></td>
              <td class="result"><span id="vol1">157</span></td>
            </tr>
            <tr>
              <td colspan="3" class="formula">
                Volume Flowrate = Mass Flowrate √ó 22.414 √∑ MW
              </td>
            </tr>
          </table>
        </div>

        <!-- Block 2: Volume ‚Üí Mass -->
        <div class="block" id="block-2">
          <div class="block-header">
            <h2>Volume ‚ñ∂ Mass Flowrate</h2>
            <button class="btn-copy" data-block="2">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col />
              <col />
              <col />
            </colgroup>
            <tr>
              <th>Volume Flowrate<br><span class="unit">Nm¬≥/h</span></th>
              <th>MW<br><span class="unit">kg/kmol</span></th>
              <th>Mass Flowrate<br><span class="unit">kg/h</span></th>
            </tr>
            <tr>
              <td><input type="number" id="vol2_in" value="157.0" step="0.1" /></td>
              <td><input type="number" id="mw2" value="29.0" step="0.1" /></td>
              <td class="result"><span id="mass2">203</span></td>
            </tr>
            <tr>
              <td colspan="3" class="formula">
                Mass Flowrate = Volume Flowrate √ó MW √∑ 22.414
              </td>
            </tr>
          </table>
        </div>
      </section>
    </section>

    <!-- Section 2: Static Head Calculation (initially hidden) -->
    <section id="section-static-head" style="display:none;">
      <section id="sheet-container-static">
        <!-- Block 3: kg/cm2 ‚ñ∂ m -->
        <div class="block" id="block-3">
          <div class="block-header">
            <h2>kg/cm¬≤ ‚ñ∂ m (Static Head)</h2>
            <button class="btn-copy" data-block="3">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col />
              <col />
              <col />
            </colgroup>
            <tr>
              <th>D. Pressure<br><span class="unit">kg/cm¬≤</span></th>
              <th>S.G<br><span class="unit">-</span></th>
              <th>Head<br><span class="unit">m</span></th>
            </tr>
            <tr>
              <td><input type="number" id="p_kgcm2" value="1.2" step="0.1" /></td>
              <td><input type="number" id="sg1" value="0.5" step="0.01" /></td>
              <td class="result"><span id="head_m">24.0</span></td>
            </tr>
            <tr>
              <td colspan="3" class="formula">
                Head (m) = D. Pressure (kg/cm¬≤) √ó 10 √∑ S.G
              </td>
            </tr>
          </table>
        </div>

        <!-- Block 4: m ‚ñ∂ kg/cm2 -->
        <div class="block" id="block-4">
          <div class="block-header">
            <h2>m ‚ñ∂ kg/cm¬≤ (Static Head)</h2>
            <button class="btn-copy" data-block="4">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col />
              <col />
              <col />
            </colgroup>
            <tr>
              <th>Head<br><span class="unit">m</span></th>
              <th>S.G<br><span class="unit">-</span></th>
              <th>D. Pressure<br><span class="unit">kg/cm¬≤</span></th>
            </tr>
            <tr>
              <td><input type="number" id="head_m_in" value="24.0" step="0.1" /></td>
              <td><input type="number" id="sg2" value="0.5" step="0.01" /></td>
              <td class="result"><span id="p_kgcm2_out">1.2</span></td>
            </tr>
            <tr>
              <td colspan="3" class="formula">
                D. Pressure (kg/cm¬≤) = Head (m) √ó S.G √∑ 10
              </td>
            </tr>
          </table>
        </div>
      </section>
    </section>

    <!-- Section 3: Vessel Volume Calculation (initially hidden) -->
    <section id="section-vessel-volume" style="display:none;">
      <section id="sheet-container-vessel">
        <!-- Vertical Vessel -->
        <div class="block" id="block-5">
          <div class="block-header">
            <h2>Vertical Vessel Volume (Liquid Level)</h2>
            <button class="btn-copy" data-block="5">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col />
              <col />
              <col />
              <col />
              <col />
            </colgroup>
            <tr>
              <th>Head Type</th>
              <th>Diameter<br><span class="unit">mm</span></th>
              <th>Length<br><span class="unit">mm</span></th>
              <th>Liquid Level<br><span class="unit">mm</span></th>
              <th>Volume<br><span class="unit">m¬≥</span></th>
            </tr>
            <tr>
              <td>
                <select id="v_head_type">
                  <option value="2:1E">2:1E</option>
                  <option value="HS">HS</option>
                  <option value="FLAT">FLAT</option>
                </select>
              </td>
              <td><input type="number" id="v_diam" value="1300" step="1" /></td>
              <td><input type="number" id="v_length" value="1020" step="1" /></td>
              <td><input type="number" id="v_level" value="1020" step="1" /></td>
              <td class="result"><span id="v_volume">1.6</span></td>
            </tr>
            <tr>
              <td colspan="5" class="formula">
                Provided Vertical Excel formulas (2:1E / HS / FLAT) are used as-is to calculate Volume (m¬≥).
              </td>
            </tr>
          </table>
<div class="vessel-visual">
  <svg id="vessel-vertical-svg"
       class="vessel-svg vessel-svg-vertical"
       viewBox="0 30 120 170">

    <!-- Body (Í∏∏Ïù¥ ÏïΩ Ï†àÎ∞òÏúºÎ°ú Ï∂ïÏÜå) -->
    <rect x="30" y="40" width="60" height="120"
          fill="none" stroke="#555" stroke-width="2" />

    <!-- Bottom Head: 2:1E -->
    <path id="vv-head-2_1E"
          d="M30 160 Q60 200 90 160"
          fill="none" stroke="#555" stroke-width="2" />

    <!-- Bottom Head: HS (Hemisphere) -->
    <path id="vv-head-HS"
          d="M30 160 A30 30 0 0 0 90 160"
          fill="none" stroke="#555" stroke-width="2"
          style="display:none;" />

    <!-- Bottom Head liquid fill (2:1E) -->
    <path id="vv-head-2_1E-liquid"
          d="M30 160 Q60 200 90 160 L90 160 L30 160 Z"
          fill="#4aa3ff" fill-opacity="0.6" />

    <!-- Bottom Head liquid fill (HS) -->
    <path id="vv-head-HS-liquid"
          d="M30 160 A30 30 0 0 0 90 160 L90 160 L30 160 Z"
          fill="#4aa3ff" fill-opacity="0.6"
          style="display:none;" />

    <!-- Ïï°Ï≤¥ (Body ÎÇ¥Î∂ÄÎßå Ï±ÑÏõÄ) -->
    <rect id="vessel-vertical-liquid"
          x="31" y="160" width="58" height="0"
          fill="#4aa3ff" fill-opacity="0.6" />
  </svg>
</div>

        </div>

        <!-- Horizontal Vessel -->
        <div class="block" id="block-6">
          <div class="block-header">
            <h2>Horizontal Vessel Volume (Liquid Level)</h2>
            <button class="btn-copy" data-block="6">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col />
              <col />
              <col />
              <col />
              <col />
            </colgroup>
            <tr>
              <th>Type<br><span class="unit">2:1E / HS</span></th>
              <th>Diameter<br><span class="unit">mm</span></th>
              <th>Length<br><span class="unit">mm</span></th>
              <th>Liquid Level<br><span class="unit">mm</span></th>
              <th>Volume<br><span class="unit">m¬≥</span></th>
            </tr>
            <tr>
              <td>
                <select id="h_head_type">
                  <option value="2:1E">2:1E</option>
                  <option value="HS">HS</option>
                </select>
              </td>
              <td><input type="number" id="h_diam" value="1550" step="1" /></td>
              <td><input type="number" id="h_length" value="4000" step="1" /></td>
              <td><input type="number" id="h_level" value="1550" step="1" /></td>
              <td class="result"><span id="h_volume">8.5</span></td>
            </tr>
            <tr>
              <td colspan="5" class="formula">
                Provided Horizontal Excel formulas are used as-is to calculate Volume (m¬≥) at the given Level.
              </td>
            </tr>
          </table>

<div class="vessel-visual">
<svg id="vessel-horizontal-svg"
     class="vessel-svg vessel-svg-horizontal"
     viewBox="0 0 260 160">>

    <!-- Body -->
    <rect x="40" y="40" width="180" height="80"
          fill="none" stroke="#555" stroke-width="2" />

    <!-- Left Head: 2:1E (Îçî Î≥ºÎ°ùÌïòÍ≤å) -->
    <path id="hv-head-2_1E-left"
          d="M40 40 Q0 80 40 120"
          fill="none" stroke="#555" stroke-width="2" />

    <!-- Right Head: 2:1E -->
    <path id="hv-head-2_1E-right"
          d="M220 40 Q260 80 220 120"
          fill="none" stroke="#555" stroke-width="2" />

    <!-- Left Head: HS (Hemisphere) -->
    <path id="hv-head-HS-left"
          d="M40 40 A40 40 0 0 0 40 120"
          fill="none" stroke="#555" stroke-width="2"
          style="display:none;" />

    <!-- Right Head: HS -->
    <path id="hv-head-HS-right"
          d="M220 40 A40 40 0 0 1 220 120"
          fill="none" stroke="#555" stroke-width="2"
          style="display:none;" />

    <!-- 2:1E liquid (Body+Head Ï†ÑÏ≤¥Î•º clipPathÎ°ú ÏûêÎ¶Ñ) -->
    <defs>
      <clipPath id="hv-clip-2_1E">
        <rect x="40" y="40" width="180" height="80" />
        <path d="M40 40 Q0 80 40 120" />
        <path d="M220 40 Q260 80 220 120" />
      </clipPath>
      <clipPath id="hv-clip-HS">
        <rect x="40" y="40" width="180" height="80" />
        <path d="M40 40 A40 40 0 0 0 40 120" />
        <path d="M220 40 A40 40 0 0 1 220 120" />
      </clipPath>
    </defs>

    <rect id="vessel-horizontal-liquid-2_1E"
          x="0" y="120" width="260" height="0"
          fill="#4aa3ff" fill-opacity="0.6"
          clip-path="url(#hv-clip-2_1E)" />

    <rect id="vessel-horizontal-liquid-HS"
          x="0" y="120" width="260" height="0"
          fill="#4aa3ff" fill-opacity="0.6"
          clip-path="url(#hv-clip-HS)"
          style="display:none;" />
  </svg>
</div>

<!-- üîπ Ïó¨Í∏∞ÍπåÏßÄ -->

</div> <!-- block-6 ÎÅù -->

        </div>
      </section>
    </section>

    <!-- Section 4: Combined Gas Law -->
    <section id="section-combined-gas" style="display:none;">
      <section id="sheet-container-combined">
        <!-- Combined Gas Law - V2 -->
        <div class="block" id="block-7">
          <div class="block-header">
            <h2>Combined Gas Law - Volume V2</h2>
            <button class="btn-copy" data-block="7">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>Constant</th>
              <th colspan="3">Initial Condition</th>
              <th colspan="3">Final Condition</th>
            </tr>
            <tr>
              <th>1 ATM<br><span class="unit">kg/cm¬≤g</span></th>
              <th>P1<br><span class="unit">kg/cm¬≤g</span></th>
              <th>T1<br><span class="unit">¬∞C</span></th>
              <th>V1<br><span class="unit">m¬≥</span></th>
              <th>P2<br><span class="unit">kg/cm¬≤g</span></th>
              <th>T2<br><span class="unit">¬∞C</span></th>
              <th>V2<br><span class="unit">m¬≥</span></th>
            </tr>
            <tr>
              <td><input type="number" id="atm_v2" class="const-input" value="1.03323" step="0.00001" /></td>
              <td><input type="number" id="p1_v2" value="12.0" step="0.1" /></td>
              <td><input type="number" id="t1_v2" value="80.0" step="0.1" /></td>
              <td><input type="number" id="v1_v2" value="12000" step="1" /></td>
              <td><input type="number" id="p2_v2" value="0.0" step="0.1" /></td>
              <td><input type="number" id="t2_v2" value="0.0" step="0.1" /></td>
              <td class="result"><span id="v2_out">0.0</span></td>
            </tr>
          </table>
        </div>

        <!-- Combined Gas Law - P2 -->
        <div class="block" id="block-8">
          <div class="block-header">
            <h2>Combined Gas Law - Pressure P2</h2>
            <button class="btn-copy" data-block="8">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>Constant</th>
              <th colspan="3">Initial Condition</th>
              <th colspan="3">Final Condition</th>
            </tr>
            <tr>
              <th>1 ATM<br><span class="unit">kg/cm¬≤g</span></th>
              <th>P1<br><span class="unit">kg/cm¬≤g</span></th>
              <th>T1<br><span class="unit">¬∞C</span></th>
              <th>V1<br><span class="unit">m¬≥</span></th>
              <th>P2<br><span class="unit">kg/cm¬≤g</span></th>
              <th>T2<br><span class="unit">¬∞C</span></th>
              <th>V2<br><span class="unit">m¬≥</span></th>
            </tr>
            <tr>
              <td><input type="number" id="atm_p2" class="const-input" value="1.03323" step="0.00001" /></td>
              <td><input type="number" id="p1_p2" value="12.0" step="0.1" /></td>
              <td><input type="number" id="t1_p2" value="80.0" step="0.1" /></td>
              <td><input type="number" id="v1_p2" value="12000" step="1" /></td>
              <td class="result"><span id="p2_out">0.0</span></td>
              <td><input type="number" id="t2_p2" value="0.0" step="0.1" /></td>
              <td><input type="number" id="v2_p2" value="117079" step="1" /></td>
            </tr>
          </table>
        </div>

        <!-- Combined Gas Law - T2 -->
        <div class="block" id="block-9">
          <div class="block-header">
            <h2>Combined Gas Law - Temperature T2</h2>
            <button class="btn-copy" data-block="9">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>Constant</th>
              <th colspan="3">Initial Condition</th>
              <th colspan="3">Final Condition</th>
            </tr>
            <tr>
              <th>1 ATM<br><span class="unit">kg/cm¬≤g</span></th>
              <th>P1<br><span class="unit">kg/cm¬≤g</span></th>
              <th>T1<br><span class="unit">¬∞C</span></th>
              <th>V1<br><span class="unit">m¬≥</span></th>
              <th>P2<br><span class="unit">kg/cm¬≤g</span></th>
              <th>T2<br><span class="unit">¬∞C</span></th>
              <th>V2<br><span class="unit">m¬≥</span></th>
            </tr>
            <tr>
              <td><input type="number" id="atm_t2" class="const-input" value="1.03323" step="0.00001" /></td>
              <td><input type="number" id="p1_t2" value="12.0" step="0.1" /></td>
              <td><input type="number" id="t1_t2" value="80.0" step="0.1" /></td>
              <td><input type="number" id="v1_t2" value="12000" step="1" /></td>
              <td><input type="number" id="p2_t2" value="0.0" step="0.1" /></td>
              <td class="result"><span id="t2_out">0.0</span></td>
              <td><input type="number" id="v2_t2" value="117079" step="1" /></td>
            </tr>
          </table>
        </div>
      </section>
    </section>


    <!-- Section 5: Gas Density Calculation -->
    <section id="section-gas-density" style="display:none;">
      <section id="sheet-container-gasdensity">
        <div class="block" id="block-10">
          <div class="block-header">
            <h2>Gas Density Calculation</h2>
            <button class="btn-copy" data-block="10">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>MW<br><span class="unit">-</span></th>
              <th>Comp. Factor (Z)<br><span class="unit">-</span></th>
              <th>Pressure<br><span class="unit">kg/cm¬≤g</span></th>
              <th>Temperature<br><span class="unit">¬∞C</span></th>
              <th>Gas Density<br><span class="unit">kg/m¬≥</span></th>
            </tr>
            <tr>
              <td><input type="number" id="gd_mw" value="20.0" step="0.1" /></td>
              <td><input type="number" id="gd_z" value="0.9" step="0.01" /></td>
              <td><input type="number" id="gd_p" value="10.0" step="0.1" /></td>
              <td><input type="number" id="gd_t" value="40.0" step="0.1" /></td>
              <td class="result"><span id="gd_rho">9.235</span></td>
            </tr>
          </table>
        </div>
      </section>
    </section>


    <!-- Section 6: Line Sizing -->
    <section id="section-line-sizing" style="display:none;">
      <section id="sheet-container-linesizing">
        <!-- Block LS1: Liquid (Incompressible) ‚Äì From Mass Flow -->
        <div class="block" id="block-ls1">
          <div class="block-header">
            <h2>Liquid Line Sizing (Mass Flow)</h2>
            <button class="btn-copy" data-block="ls1">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>Mass Flow<br><span class="unit">kg/h</span></th>
              <th>Density<br><span class="unit">kg/m¬≥</span></th>
              <th>Viscosity<br><span class="unit">cP</span></th>
              <th>Press.<br><span class="unit">kg/cm¬≤g</span></th>
              <th>Temp.<br><span class="unit">¬∞C</span></th>
              <th>Pipe ID<br><span class="unit">inch</span></th>
              <th>Rough.<br><span class="unit">ft</span></th>
              <th>Vol. Flow<br><span class="unit">m¬≥/h</span></th>
              <th>ŒîP / 100m<br><span class="unit">kg/cm¬≤</span></th>
              <th>Velocity<br><span class="unit">m/s</span></th>
            </tr>
            <tr>
              <td><input type="number" id="ls1_mass" value="10000.0" step="0.1" /></td>
              <td><input type="number" id="ls1_rho" value="1031.0" step="0.1" /></td>
              <td><input type="number" id="ls1_mu" value="2.2" step="0.01" /></td>
              <td><input type="number" id="ls1_p" value="0.5" step="0.01" /></td>
              <td><input type="number" id="ls1_t" value="50.0" step="0.1" /></td>
              <td><input type="number" id="ls1_d" value="2.0" step="0.01" /></td>
              <td><input type="number" id="ls1_eps" value="0.00015" step="0.00001" /></td>
              <td class="result"><span id="ls1_q">9.699</span></td>
              <td class="result"><span id="ls1_dp100">0.470</span></td>
              <td class="result"><span id="ls1_v">1.329</span></td>
            </tr>
          </table>
        </div>

        <!-- Block LS2: Liquid (Incompressible) ‚Äì From Volumetric Flow -->
        <div class="block" id="block-ls2">
          <div class="block-header">
            <h2>Liquid Line Sizing (Volumetric Flow)</h2>
            <button class="btn-copy" data-block="ls2">Copy to Excel (with formulas)</button>
          </div>
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>Vol. Flow<br><span class="unit">m¬≥/h</span></th>
              <th>Density<br><span class="unit">kg/m¬≥</span></th>
              <th>Viscosity<br><span class="unit">cP</span></th>
              <th>Press.<br><span class="unit">kg/cm¬≤g</span></th>
              <th>Temp.<br><span class="unit">¬∞C</span></th>
              <th>Pipe ID<br><span class="unit">inch</span></th>
              <th>Rough.<br><span class="unit">ft</span></th>
              <th>Mass Flow<br><span class="unit">kg/h</span></th>
              <th>ŒîP / 100m<br><span class="unit">kg/cm¬≤</span></th>
              <th>Velocity<br><span class="unit">m/s</span></th>
            </tr>
            <tr>
              <td><input type="number" id="ls2_q" value="9.7" step="0.1" /></td>
              <td><input type="number" id="ls2_rho" value="1031.0" step="0.1" /></td>
              <td><input type="number" id="ls2_mu" value="2.2" step="0.01" /></td>
              <td><input type="number" id="ls2_p" value="0.5" step="0.01" /></td>
              <td><input type="number" id="ls2_t" value="50.0" step="0.1" /></td>
              <td><input type="number" id="ls2_d" value="2.0" step="0.01" /></td>
              <td><input type="number" id="ls2_eps" value="0.00015" step="0.00001" /></td>
              <td class="result"><span id="ls2_mass">10000.0</span></td>
              <td class="result"><span id="ls2_dp100">0.470</span></td>
              <td class="result"><span id="ls2_v">1.329</span></td>
            </tr>
          </table>
        </div>

        
        <!-- Block LS3: Vapor ‚Äì Darcy Pressure Drop (Incompressible Approximation) -->
        <div class="block" id="block-ls3">
          <div class="block-header">
            <h2>Vapor Darcy Pressure Drop (Approx.)</h2>
            <button class="btn-copy" data-block="ls3">Copy to Excel (with formulas)</button>
          </div>

          <!-- Input table -->
          <table class="calc-table">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>Mass Flow<br><span class="unit">kg/h</span></th>
              <th>MW<br><span class="unit">kg/kmol</span></th>
              <th>Viscosity<br><span class="unit">cP</span></th>
              <th>Z-factor<br><span class="unit">-</span></th>
              <th>k<br><span class="unit">Cp/Cv</span></th>
              <th>Known Side<br><span class="unit">1=In / 2=Out</span></th>
              <th>Known P<br><span class="unit">kg/cm¬≤g</span></th>
              <th>Temp<br><span class="unit">¬∞C</span></th>
              <th>Pipe ID<br><span class="unit">inch</span></th>
              <th>Rough.<br><span class="unit">ft</span></th>
              <th>EQ Length<br><span class="unit">m</span></th>
            </tr>
            <tr>
              <td><input type="number" id="ls3_mass" value="11500.0" step="0.1" /></td>
              <td><input type="number" id="ls3_mw" value="18.0" step="0.1" /></td>
              <td><input type="number" id="ls3_mu" value="0.010" step="0.001" /></td>
              <td><input type="number" id="ls3_z" value="0.90" step="0.01" /></td>
              <td><input type="number" id="ls3_k" value="1.3" step="0.01" /></td>
              <td><input type="number" id="ls3_side" value="1" step="1" /></td>
              <td><input type="number" id="ls3_pknown" value="2.65" step="0.01" /></td>
              <td><input type="number" id="ls3_t" value="150.0" step="0.1" /></td>
              <td><input type="number" id="ls3_d" value="7.981" step="0.001" /></td>
              <td><input type="number" id="ls3_eps" value="0.00015" step="0.00001" /></td>
              <td><input type="number" id="ls3_leq" value="100.0" step="0.1" /></td>
            </tr>
          </table>

          <!-- Output table -->
          <table class="calc-table" style="margin-top:8px;">
            <colgroup>
              <col /><col /><col /><col /><col /><col /><col /><col /><col /><col /><col /><col /><col />
            </colgroup>
            <tr>
              <th>P_in<br><span class="unit">kg/cm¬≤g</span></th>
              <th>P_out<br><span class="unit">kg/cm¬≤g</span></th>
              <th>Total ŒîP<br><span class="unit">kg/cm¬≤</span></th>
              <th>ŒîP / 100m<br><span class="unit">kg/cm¬≤</span></th>
              <th>œÅ_in<br><span class="unit">kg/m¬≥</span></th>
              <th>œÅ_out<br><span class="unit">kg/m¬≥</span></th>
              <th>v_in<br><span class="unit">m/s</span></th>
              <th>v_out<br><span class="unit">m/s</span></th>
              <th>Mach_in<br><span class="unit">-</span></th>
              <th>Mach_out<br><span class="unit">-</span></th>
              <th>a (Sonic)<br><span class="unit">m/s</span></th>
              <th>Erosional Limit v<sub>e</sub><br><span class="unit">m/s</span></th>
              <th>v<sub>out</sub> / v<sub>e</sub><br><span class="unit">-</span></th>
            </tr>
            <tr>
              <td class="result"><span id="ls3_pin">2.650</span></td>
              <td class="result"><span id="ls3_pout">2.475</span></td>
              <td class="result"><span id="ls3_dp">0.175</span></td>
              <td class="result"><span id="ls3_dp100">0.175</span></td>
              <td class="result"><span id="ls3_rho_in">2.05</span></td>
              <td class="result"><span id="ls3_rho_out">1.96</span></td>
              <td class="result"><span id="ls3_v_in">48.20</span></td>
              <td class="result"><span id="ls3_v_out">50.61</span></td>
              <td class="result"><span id="ls3_mach_in">0.096</span></td>
              <td class="result"><span id="ls3_mach_out">0.100</span></td>
              <td class="result"><span id="ls3_a">504.1</span></td>
              <td class="result"><span id="ls3_ve">120.0</span></td>
              <td class="result"><span id="ls3_vratio">0.42</span></td>
            </tr>
          </table>
        </div>

</div>
      </section>
    </section>
  
    <!-- Extra placeholder sections for future modules -->
      <!-- Residence Time -->
      <section id="section-residence" style="display:none;">
        <section id="sheet-container-residence">
          <div class="block" id="block-residence">
            <div class="block-header">
              <h2>Residence Time</h2>
              <button class="btn-copy" data-block="residence">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>Holdup Volume<br><span class="unit">m¬≥</span></th>
                <th>Flowrate<br><span class="unit">m¬≥/h</span></th>
                <th>Residence Time<br><span class="unit">h</span></th>
                <th>Residence Time<br><span class="unit">min</span></th>
              </tr>
              <tr>
                <td><input type="number" id="res_vol" value="10.0" step="0.1" /></td>
                <td><input type="number" id="res_q" value="20.0" step="0.1" /></td>
                <td class="result"><span id="res_time_h">0.5</span></td>
                <td class="result"><span id="res_time_min">30.0</span></td>
              </tr>
              <tr>
                <td colspan="4" class="formula">
                  Residence Time (h) = Volume (m¬≥) √∑ Flowrate (m¬≥/h)
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- NPSHa -->
      <section id="section-npsh" style="display:none;">
        <section id="sheet-container-npsh">
          <div class="block" id="block-npsh">
            <div class="block-header">
              <h2>NPSHa Calculation</h2>
              <button class="btn-copy" data-block="npsh">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>Surface Pressure<br><span class="unit">kg/cm¬≤g</span></th>
                <th>Static Head (above pump)<br><span class="unit">m</span></th>
                <th>Suction Line Loss<br><span class="unit">m</span></th>
                <th>Specific Gravity<br><span class="unit">-</span></th>
                <th>Vapor Pressure<br><span class="unit">kg/cm¬≤ abs</span></th>
                <th>NPSHa<br><span class="unit">m</span></th>
              </tr>
              <tr>
                <td><input type="number" id="npsh_ps" value="0.0" step="0.01" /></td>
                <td><input type="number" id="npsh_hs" value="5.0" step="0.1" /></td>
                <td><input type="number" id="npsh_hf" value="1.0" step="0.1" /></td>
                <td><input type="number" id="npsh_sg" value="1.0" step="0.01" /></td>
                <td><input type="number" id="npsh_pv" value="0.2" step="0.01" /></td>
                <td class="result"><span id="npsh_avail">4.0</span></td>
              </tr>
              <tr>
                <td colspan="6" class="formula">
                  NPSHa (m) = ((P<sub>surface,abs</sub> √ó 10) √∑ SG) + H<sub>s</sub> ‚àí h<sub>f</sub> ‚àí ((P<sub>v,abs</sub> √ó 10) √∑ SG)
                  &nbsp;&nbsp;[P in kg/cm¬≤, head ‚âà 10 m per kg/cm¬≤]
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- Pump Power -->
      <section id="section-pump-power" style="display:none;">
        <section id="sheet-container-pump-power">
          <div class="block" id="block-pump-power">
            <div class="block-header">
              <h2>Hydraulic Power &amp; Shaft Power</h2>
              <button class="btn-copy" data-block="pump-power">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>Flowrate<br><span class="unit">m¬≥/h</span></th>
                <th>ŒîP<br><span class="unit">kg/cm¬≤</span></th>
                <th>P<sub>hyd</sub><br><span class="unit">kW</span></th>
                <th>Efficiency<br><span class="unit">%</span></th>
                <th>P<sub>shaft</sub><br><span class="unit">kW</span></th>
              </tr>
              <tr>
                <td><input type="number" id="hp_q" value="50.0" step="0.1" /></td>
                <td><input type="number" id="hp_dp" value="5.0" step="0.1" /></td>
                <td class="result"><span id="hp_ph">6.8</span></td>
                <td><input type="number" id="hp_eff" value="70.0" step="0.1" /></td>
                <td class="result"><span id="hp_ps">9.7</span></td>
              </tr>
              <tr>
                <td colspan="5" class="formula">
                  P<sub>hyd</sub> (kW) = ŒîP(Pa) √ó Q(m¬≥/s) √∑ 1000,
                  &nbsp; ŒîP(Pa) = ŒîP(kg/cm¬≤) √ó 98,066.5
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- Heat Duty / Area -->
      <section id="section-heat-duty" style="display:none;">
        <section id="sheet-container-heat-duty">
          <div class="block" id="block-heat-duty">
            <div class="block-header">
              <h2>Heat Duty / Outlet Temperature / Required Area</h2>
              <button class="btn-copy" data-block="heat-duty">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>Mass Flow<br><span class="unit">kg/h</span></th>
                <th>C<sub>p</sub><br><span class="unit">kJ/kg¬∑K</span></th>
                <th>T<sub>in</sub><br><span class="unit">¬∞C</span></th>
                <th>T<sub>out</sub><br><span class="unit">¬∞C</span></th>
                <th>U<br><span class="unit">W/m¬≤¬∑K</span></th>
                <th>LMTD<br><span class="unit">K</span></th>
                <th>Heat Duty / Area<br><span class="unit">Q (kW) / A (m¬≤)</span></th>
              </tr>
              <tr>
                <td><input type="number" id="hd_m" value="10000" step="1" /></td>
                <td><input type="number" id="hd_cp" value="4.19" step="0.01" /></td>
                <td><input type="number" id="hd_tin" value="20.0" step="0.1" /></td>
                <td><input type="number" id="hd_tout" value="80.0" step="0.1" /></td>
                <td><input type="number" id="hd_u" value="800" step="1" /></td>
                <td><input type="number" id="hd_lmtd" value="25.0" step="0.1" /></td>
                <td class="result">
                  <span id="hd_q">697.0</span> kW /
                  <span id="hd_a">34.9</span> m¬≤
                </td>
              </tr>
              <tr>
                <td colspan="7" class="formula">
                  Q (kW) = m(kg/h) √ó C<sub>p</sub>(kJ/kg¬∑K) √ó (T<sub>out</sub> ‚àí T<sub>in</sub>) √∑ 3600,
                  &nbsp; A = Q(W) √∑ (U √ó LMTD)
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- Steam / Condensate Duty -->
      <section id="section-steam-duty" style="display:none;">
        <section id="sheet-container-steam-duty">
          <div class="block" id="block-steam-duty">
            <div class="block-header">
              <h2>Steam / Condensate Duty &amp; Mass Flow</h2>
              <button class="btn-copy" data-block="steam-duty">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>Heat Duty<br><span class="unit">kW</span></th>
                <th>Latent Heat Œª<br><span class="unit">kJ/kg</span></th>
                <th>Steam Flow<br><span class="unit">kg/h</span></th>
                <th>Condensate Flow<br><span class="unit">kg/h</span></th>
              </tr>
              <tr>
                <td><input type="number" id="sd_q" value="500.0" step="1" /></td>
                <td><input type="number" id="sd_lambda" value="2200" step="10" /></td>
                <td class="result"><span id="sd_msteam">818.2</span></td>
                <td class="result"><span id="sd_mcond">818.2</span></td>
              </tr>
              <tr>
                <td colspan="4" class="formula">
                  Steam Flow (kg/h) = Q(kW) √ó 3600 √∑ Œª(kJ/kg) &nbsp; (Condensate ‚âà Steam Flow)
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- Control Valve Cv Inversion -->
      <section id="section-cv-invert" style="display:none;">
        <section id="sheet-container-cv-invert">
          <div class="block" id="block-cv">
            <div class="block-header">
              <h2>Control Valve ‚Äì Cv Inversion (Q ‚Üî ŒîP)</h2>
              <button class="btn-copy" data-block="cv-invert">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>Flow Q (m¬≥/h)<br><span class="unit">input</span></th>
                <th>ŒîP (kg/cm¬≤)<br><span class="unit">input</span></th>
                <th>Specific Gravity<br><span class="unit">-</span></th>
                <th>Cv<br><span class="unit">US gpm-based</span></th>
                <th>Q from Cv &amp; ŒîP<br><span class="unit">m¬≥/h</span></th>
                <th>ŒîP from Cv &amp; Q<br><span class="unit">kg/cm¬≤</span></th>
              </tr>
              <tr>
                <td><input type="number" id="cv_q_in" value="50.0" step="0.1" /></td>
                <td><input type="number" id="cv_dp_in" value="1.0" step="0.01" /></td>
                <td><input type="number" id="cv_sg" value="1.0" step="0.01" /></td>
                <td><input type="number" id="cv_cv" value="20.0" step="0.1" /></td>
                <td class="result"><span id="cv_q_calc">47.5</span></td>
                <td class="result"><span id="cv_dp_calc">1.11</span></td>
              </tr>
              <tr>
                <td colspan="6" class="formula">
                  Q(gpm) = Cv ¬∑ ‚àö(ŒîP(psi)/SG),
                  &nbsp; Q(m¬≥/h) ‚âà Q(gpm) √∑ 4.4029,
                  &nbsp; ŒîP(kg/cm¬≤) ‚âà ŒîP(psi) √ó 0.0703
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- Restriction Orifice ‚Äì Liquid Flow -->
      <section id="section-orifice" style="display:none;">
        <section id="sheet-container-orifice">
          <div class="block" id="block-orifice">
            <div class="block-header">
              <h2>Restriction Orifice ‚Äì Liquid Flow</h2>
              <button class="btn-copy" data-block="orifice">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>ŒîP<br><span class="unit">kg/cm¬≤</span></th>
                <th>Orifice Diameter<br><span class="unit">mm</span></th>
                <th>Discharge Coeff. C<br><span class="unit">-</span></th>
                <th>Density<br><span class="unit">kg/m¬≥</span></th>
                <th>Flowrate Q<br><span class="unit">m¬≥/h</span></th>
                <th>Velocity in Orifice<br><span class="unit">m/s</span></th>
              </tr>
              <tr>
                <td><input type="number" id="ro_dp" value="1.0" step="0.01" /></td>
                <td><input type="number" id="ro_d" value="25.0" step="0.1" /></td>
                <td><input type="number" id="ro_c" value="0.62" step="0.01" /></td>
                <td><input type="number" id="ro_rho" value="1000" step="1" /></td>
                <td class="result"><span id="ro_q">13.7</span></td>
                <td class="result"><span id="ro_v">7.7</span></td>
              </tr>
              <tr>
                <td colspan="6" class="formula">
                  Q = C ¬∑ A ¬∑ ‚àö(2 ŒîP / œÅ), &nbsp; A = œÄ d¬≤ / 4, &nbsp; ŒîP in Pa, œÅ in kg/m¬≥
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>

      <!-- Mixing Temperature -->
      <section id="section-mixing-temp" style="display:none;">
        <section id="sheet-container-mixing-temp">
          <div class="block" id="block-mixing">
            <div class="block-header">
              <h2>Mixing Temperature (Two-Stream)</h2>
              <button class="btn-copy" data-block="mixing-temp">Copy to Excel (with formulas)</button>
            </div>
            <table class="calc-table">
              <colgroup>
                <col /><col /><col /><col /><col /><col /><col />
              </colgroup>
              <tr>
                <th>m‚ÇÅ<br><span class="unit">kg/h</span></th>
                <th>Cp‚ÇÅ<br><span class="unit">kJ/kg¬∑K</span></th>
                <th>T‚ÇÅ<br><span class="unit">¬∞C</span></th>
                <th>m‚ÇÇ<br><span class="unit">kg/h</span></th>
                <th>Cp‚ÇÇ<br><span class="unit">kJ/kg¬∑K</span></th>
                <th>T‚ÇÇ<br><span class="unit">¬∞C</span></th>
                <th>T<sub>mix</sub><br><span class="unit">¬∞C</span></th>
              </tr>
              <tr>
                <td><input type="number" id="mix_m1" value="1000" step="1" /></td>
                <td><input type="number" id="mix_cp1" value="4.19" step="0.01" /></td>
                <td><input type="number" id="mix_t1" value="20.0" step="0.1" /></td>
                <td><input type="number" id="mix_m2" value="500" step="1" /></td>
                <td><input type="number" id="mix_cp2" value="4.19" step="0.01" /></td>
                <td><input type="number" id="mix_t2" value="80.0" step="0.1" /></td>
                <td class="result"><span id="mix_tmix">40.0</span></td>
              </tr>
              <tr>
                <td colspan="7" class="formula">
                  T<sub>mix</sub> = (m‚ÇÅ C‚Çö‚ÇÅ T‚ÇÅ + m‚ÇÇ C‚Çö‚ÇÇ T‚ÇÇ) √∑ (m‚ÇÅ C‚Çö‚ÇÅ + m‚ÇÇ C‚Çö‚ÇÇ)
                </td>
              </tr>
            </table>
          </div>
        </section>
      </section>
</main>

  <script src="main.js"></script>
</body>
</html>
